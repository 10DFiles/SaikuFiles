eval((function(s7a){for(var T7a="",H7a=0,p7a=function(s7a,w7a){for(var g7a=0,E7a=0;E7a<w7a;E7a++){g7a*=96;var X7a=s7a.charCodeAt(E7a);if(X7a>=32&&X7a<=127){g7a+=X7a-32;}}return g7a;};H7a<s7a.length;){if(s7a.charAt(H7a)!="`")T7a+=s7a.charAt(H7a++);else{if(s7a.charAt(H7a+1)!="`"){var a7a=p7a(s7a.charAt(H7a+3),1)+5;T7a+=T7a.substr(T7a.length-p7a(s7a.substr(H7a+1,2),2)-a7a,a7a);H7a+=4;}else{T7a+="`";H7a+=2;}}}return T7a;})("var l0G={\'e3\':0,\'x3\':2,\'j3\':3,\'r\':(function(){var y=` ($B,Z` .!M=Z&0xffff,x=Z-M;return ((x*B|0)+(M` # )|0;},m=function(B,Z,M){if(C[M]!==undefined){return C[M];}var x=0xcc9e2d51,O=0x1b873593;var n=M` # V=Z&~0x3;for(var N=0;N<V;N+=4){var k=(B.charCodeAt(N)&0xff)|(` )*+1` 3\"<<8` +.2` 5$16` J.3` T$24);k=y(k,x);k=((k&0x1ff` V!5)|(k>>>17` >#O);n^=k;n=((n&0x7` C#3)|(n>>>19);n=(n*5+0xe6546b64)|0;}k=0;switch(Z%4){case 3:k=(B.charCodeAt(V+2)&0xff)<<16;` A 2:k|` 6,1` >$8` @!1` 3.` =\";k=y(k,x);k=((k&0x1ff` W 15)|(k>>>17` >#O);n^=k;}n^=Z;n^=n>>>16;n=y(n,0x85ebca6b` B ` 7 3` 3$c2b2ae35` 2%6;C[M]=n;return n;},C={}` (#{Y0:y,L:m};})(),\'Z3\':1};var SaikuMapRenderer=(function(){var u=10,U=\'#\',Q=\'on\',D=\'ul.chart [href=\"#map\"]\',l=\'disabled\',p` =&> li#` N editor\',s=5104170,P=\'scroll\',d=7790885,h=1525909274,w=1858533190,o=\', \',W=\'map_marker\',T=\'lat\',H=\'country\',E=\'state\',K` \/\"y\',X=\'city\',g=\'street\',I=\'\',R=\'map_heat\',q=null;function a(B){var Z=\'saiku.ui.map.options\',M` .&render.type\',x=\'mapDefinition\',O=\'tab:select\',n=true,V=\'run_workspace_map\',N` Y -\';if(!(this instanceof a)){return new a(B);}B=Array.prototype.slice.call(arguments);var k,y,m,C,S;this._idMap=_.uniqueId(N);if(B[l0G.j3]===V){_.extend(this,` 7!e3]);this._runWorkspaceMap=n;if(` =$.data){` E!data=B[0` 0!.rawdata;}else` 5)` V#renderer` B%` A!el=function(){return {canvas:$(` @ ` S$el).find(\'.` <!_wrapper\')};};` H _workspaceSize=function(){return {width:` H ` C$.$el.find(\'` +%_results\').` O (),height` .J` O!()};};k=new SaikuChartRenderer(q,{});y=k.process_data_tree({data:this.` 1 },true,true);m=B[l0G.Z3];C` %\"x3];S=t(y,m,C);` P%=G` \/ S` (\'.mapType=m` &*Properties=C` J!adjust();Saiku.session.bind(O,` 8&Trigger);}else{_.extend(this,B[l0G.e3]);` N _data=` -$` .\"options` 1\"Z` \/$el=function(){return {canvas:$(` P(.htmlObject)};};` 7!workspaceSize=function(){return {width:(` H!el().canvas.` 4 ()+10),height` 2\/` 4!` A!};};k=new SaikuChartRenderer(q,{});y=k.process_data_tree({data:this.` 1 },true,true);if(B&&B[l0G.Z3]&&_.has(` ($,x)){m=` 8$.mapDefinition.ma` \"\'type;C` 53;}else{m` 9\"e3].query.properties[M]` W$` +0Z];}S=t(y,m,C);this._data=G` \/ S` (\'.mapType=m` &*Properties=C;}}function t(B,Z,M){var x=\'lon\',O=B.metadata,n=l0G.e3,V=` \"\"N={},k,y;if(Z===R){N.fields=[];if(M.mapDefinition.lat` ; ===q||` #6undefined){k=[];if(` >+search.street!` H&&&` +;I){k.push({\'name\':g,\'val\':` =8});}if(` -2city!==undefined&&` +9I){k.push({\'name\':X,\'val\':` =6});}if(` *3ounty!==undefined&&` +;I){k.push({\'name\':K,\'val\':` =8});}if(` -2state!==undefined&&` +:I){k.push({\'name\':E,\'val\':` =7});}if(` ,2country!==undefined&&` +<I){k.push({\'name\':H,\'val\':` =9});}}else{k=[];k.push({\'name\':T,\'val\':M.mapDefinition.latfield})` B+x` :3on` J#}M.lookup` , s=k;y=k?k.length:0;while(n<y){if(O[V]&&` \" .colName===k[n].val)){N.fields.push` J );V=l0G.e3;n++;}else{V++;}}` \'  if(Z===W){var m=O?O.length:` Q\"N.fields=[];N.metric=I;if(M.mapDefinition.lat` F ===q||` #6undefined){k=[];if(` >+search.street!` H&&&` +;I){k.push({\'name\':g,\'val\':` =8});}if(` -2city!==undefined&&` +9I){k.push({\'name\':X,\'val\':` =6});}if(` *3ounty!==undefined&&` +;I){k.push({\'name\':K,\'val\':` =8});}if(` -2state!==undefined&&` +:I){k.push({\'name\':E,\'val\':` =7});}if(` ,2country!==undefined&&` +<I){k.push({\'name\':H,\'val\':` =9});}}else{k=[];k.push({\'name\':T,\'val\':M.mapDefinition.latfield})` B+x` :3on` J#}M.lookup` , s=k;y=k?k.length:0;while(n<y){if(O[V]&&` \" .colName===k[n].val)){N.fields.push` J );V=l0G.e3;n++;}else{V++;}}for(` 4$V<m;V++){if` S .colName===M.mapDefinition.metric){N` #\"=O[V];}}}return N;}function G(B,Z,M){var x={names:[],groupN` &#valu` -&V` \'#},O=B.resultset?B` \"%.length:l0G.e3,n=M.fields?M` \"\"` 3*V=I,N=[],k,y;if(Z===R){for(k=` >!;k<O;k++){if(M.fields.length>l0G.Z3` K!y` I#y<n;y` J\"_.isEmpty(V)){V=B.resultset[k][M.fields[y].colIndex];}else{V+=o;V+` ,B}x.names.push(V);V=I;}else{if(` M#){` :(B.resultset[k][` >#[0].colIndex]);V=` $?;if(` ;(+l0G.Z3]&&(V===` \'0[M.fields[l0G.e3].colIndex])){}else{x.groupNames.push(V);V=I;}}}}` >  if(Z===W){for(k=l0G.e3;k<O;k++){if(M.fields.length>l0G.Z3` K!y` I#y<n;y` J\"_.isEmpty(V)){V=B.resultset[k][M.fields[y].colIndex];}else{V+=o;V+` ,B}x.names.push(V);x.valu` )#B.resultset[k][M.metric.colIndex].f);V=I;}else{if(M.fields){x.names.push(B.resultset[k][` >#[0].colIndex]);x.valu` ;4metric` G%.f);V=` 6,fields[0]` @%;if(` ;(+l0G.Z3]&&(V===` \'0[M.fields[l0G.e3].colIndex])){N.push(` M(][M.metric` A%.f);}else` %Hx.groupNames` Q!V` ,$Valu` .#N);V=I;N=[];}}}}}return x;}function k0(O){var n=\'object\',V=\': <\/b>\',N=\'<b>\',k=\'Loading map...\',y=20,m=[],C=[],S=[],F,J;if(O.mapType===R){` - lookupfields[l0G.e3].name===T){F=O` ) .split(o);C.push(Number(F` L#)` $1Z` 5 m` N!C);C=[];O.map.bounds` N!m)` .\"fitB` 3 (` 9\');Saiku.leaflet.heatLayer(m,{minOpacity:y,radius:y}).addTo(O.map);}else{Saiku.ui.block(k);J=x0(O);$.getJSON(Settings.MAPS_OSM_NOMINATIM+\'search?\'+J+\'&format=json&polygon=1&addressdetails=1\',function(B){for(var Z=0,M=B.length;Z<M;Z++){if(B[Z]&&B[Z].lat` \"#on){C.push(Number` C .lat));` %\/on));m` L!C);O.map.bounds` H!m);}C=[];}` 6!fitB` : (` @\');Saiku.leaflet.heatLayer(m,{minOpacity:20,radius:20}).addTo(O.map);}).done(function(){Saiku.ui.unblock(` A fail` <%B,Z,M){var x=Z+\', \'+M;console.log(\'Request Failed: \'+x);Saiku.ui.unblock();});}}else if(O.mapType===W){` - lookupfields[l0G.e3].name===T){F=O` ) .split(o);Saiku.leaflet.marker(new ` +)LatLng(F[l0G.e3],` $!Z3])).addTo(O.map).bindPopup(N+O.metric+V+((typeof O.value===n)?` &\".join(o):` 6\"));O.map.bounds.push([F[l0G.e3],` $!Z3]]` A#fitB` G (` M\');}else{Saiku.ui.block(k);J=x0(O);$.getJSON(Settings.MAPS_OSM_NOMINATIM+\'search?\'+J+\'&format=json&polygon=1&addressdetails=1\',function(B){for(var Z=0,M=B.length;Z<M;Z++){if(B[Z]&&B[Z].lat` \"#on){Saiku.leaflet.marker([` B#,` A#]).addTo(O.map).bindPopup(` F display_name+\'<br>\'+\'<b>\'+O.metric+\': <\/b>\'+((typeof O.value===\'object\')?` -\".join(\', \'):` @\"));O.map.bounds.push([B[Z].lat,` #!on]);}}` C!fitB` G (` M\');}).done(function(){Saiku.ui.unblock(` A fail` <%B,Z,M){var x=Z+\', \'+M;console.log(\'Request Failed: \'+x);Saiku.ui.unblock();});}}}function x0(B){var Z=\'country=\',M=\'state=\',x` 1\"y=\',O=\'ci` % n=\'&\',V=\'street=\',N=B.lookupfields,k=B.name.split(o),y=N.length,m=I,C;for(C=l0G.e3;C<y;C++){if(N[C]` X ===g){m+=V+k[C]+n;}else ` 5*X` ? O` \'8K` ? x` \'8E` ? M` \'8H` ? Z` ;$}return m;}var A=w,z=-h,j0=l0G.x3;for(var c` ,!Z3;l0G.r.L(c0.toString(),c` \"\'.length,d)!==A;c0++){i++;$(self._options.htmlObject).parent().pa` \"\"unbind(P);fields.push({\'name\':H,\'val\':mapProperties.mapDefinition.search.country});newData.groupValues.push(v` \' Raw);field` 0\"{\'name\':T,\'val\':mapProperties.mapDefinition.lat` V });j0+=l0G.x3;}if(l0G.r.L(j0.toString(),j` \"\'.length,s)!==z){this.workspace.querytoolbar.$el.find(p).attr(l,l);` -@D).addClass(Q);i++;args.map.bounds.push(addressPoints);this._el().canvas.find(U+` 3!idMap).height(` G!workspaceSize(` 5#-u);}\'use strict\';a.prototype.resize=function(){var B=\'map\',Z=document.fullscreenElement||` 3$mozFullS` (2webkitFulls` 6\';if(Z){this._el().canvas.find(\'#\'+` 5!idMap).width(` H!workspaceSize(` 5\");` J!el().canvas.find(\'#\'+` R!idMap).height(` I!workspaceSize(` 5#);}else{if(Settings.MODE===B){` T!el().canvas.find(\'#\'+` 5!idMap).width(` H!workspaceSize(` 5\");` J!el().canvas.find(\'#\'+` R!idMap).height(` I!workspaceSize(` 5#);}else{` R!el().canvas.find(\'#\'+` Y!idMap).width(` H!workspaceSize(` 5\"-10);` M!el().canvas.find(\'#\'+` U!idMap).height(` I!workspaceSize(` 5#-10);}}};a.prototype.adjust=function(){var B=this;$(window).resize(` <&B` ,#);});};a.prototype.adjustTrigger=` J&_.defer(` (&var B=\'resize\';$(window).t` Y!(B);});};a.prototype.renderMap=function(){var B=this._data.names.length,Z,M,x;` 8!el().canvas.empty()` \'.append(\'<div class=\"map-render\" id=\"\'+` R!idMap+\'\"><\/div>\');` 3 resize();if(` C!runWorkspaceMap){` [ w` +#.querytoolbar.$el.find(\'ul.chart > li\')` \/\"a\').removeClass(\'on\');this.workspace.querytoolbar.$el` U\"ul.chart [href=\"#export_button\"]\').parent().attr(\'disabled\',\'` \"$);this.workspace.querytoolbar.$el.find(\'ul.chart > li#` & editor\').attr(\'disabled\',\'` \"$);this.workspace.querytoolbar.$el.find(\'ul.chart [href=\"#map\"]\').addClass(\'on\');}this._map=Saiku.leaflet.map(` 6!idMap).setView([21.505,-0.09],2);` A!map.bounds=[];if` W\"data.mapType===\'map_heat\'){Settings.MAPS_OPTIONS.OSM.subdomains=\'1234\';}else{delete  ` 6?;}Saiku.leaflet.tileLayer(` P)TILE_LAYER.OSM[this._data.mapType],` C)OPTIONS.OSM).addTo(` O!map);` Z!el().canvas.find(\'#\'+` @!idMap)` \/\".leaflet-top\').css(\'zIndex\',\'100\');if(` S!data.names.length===` \/&groupN` 4&){Z` 4\'` U ;M` G\'values;}else{if(` C&groupNames.length>0){Z` Q\'` 8%;M` \',Values;}else` I)n` @-v` F\"}for(x=0;x<B;x++){k0({i:x,len:B,map:` Q!map,mapType` +\"data.` ,\",name:Z[x],value:M[x],metric` @*Properties.mapDefinition.` H!,search` -C` H!,lookupfields` A5` :\'});}};return a;}())"));